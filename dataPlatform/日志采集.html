<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<title>日志采集</title>
	</head>
<body>
<h1>日志采集</h1>

<hr />

<h3>浏览器页面日志采集</h3>

<ol>
	<li>页面浏览日志采集

		<p>指当一个页面被浏览器加载呈现时采集的日志。</p>

		<p>这类日志是最基础的互联网日志，也是目前所有互联网产品的两大基本指标：页面浏览量（pv）和访客数（uv）的统计基础。</p></li>
	<li>页面交互日志采集

		<p>当页面加载和渲染完成之后，用户可以在页面上执行各类操作。互动设计都要求采集用户行为数据，以便通过量化获知用户的兴趣点或者体验优化点。交互日志采集就是为此类业务场景而生的。</p></li>
</ol>

<h5>页面浏览日志采集 流程</h5>

<p>网站页面是互联网服务的基本载体，HTML页面是最普遍的业务形态。采集页面被浏览器加载展现的记录，是最原始的互联网日志采集需求，也是一切互联网数据分析得以展开的基础和前提。</p>

<p>目前典型的网页访问过程是以浏览器请求、服务器响应并返回所请求的内容这种模式进行的，浏览器和服务器之间的通信普遍遵守HTTP协议。</p>

<p>一次典型的页面访问过程：</p>

<ol>
	<li>用户点击链接</li>
	<li>浏览器向服务器发起HTTP请求

		<p>按照HTTP协议，一个标准的HTTP请求由三部分组成：</p>

		<ol>
			<li>请求行

				<p>请求方法、所请求资源的URL和HTTP协议版本好</p></li>
			<li>请求报头

				<p>是浏览器在请求时向服务器提交的附加信息，请求报头一般会附加很多内容项（每项内容被称为一个头域）。如果用户在本次访问前已经访问过或者已经登录，则一般都会在请求头中附加一个或多个被称为Cookie的数据项，记录用户上一次访问时的状态或者身份信息。</p></li>
			<li>请求正文

				<p>可选。一般为空。</p></li>
		</ol></li>
	<li>服务器接收并解析请求

		<p>服务器端的业务处理模块按业务逻辑处理本次请求并按照HTTP协议规定的格式，将处理结果以HTTP响应形式发回浏览器。</p>

		<p>一个标准的HTTP响应由三部分组成：</p>

		<ol>
			<li>状态行

				<p>标识了服务器对于此次HTTP请求的处理结果</p></li>
			<li>响应报头

				<p>附加数据项，将在浏览器端被读取和使用。</p></li>
			<li>响应正文

				<p>浏览器请求的文档、图片、脚本等都会包装在正文内返回浏览器。</p></li>
		</ol></li>
	<li>浏览器接收到服务器的响应内容，并将其按照文档规范展现给用户，从而完成一次请求。</li>
</ol>

<p>以上描述了一次典型的网页浏览过程，如果需要记录这次浏览行为，采集思路将是：在HTML文档内的适当位置增加一个日志采集节点，当浏览器解析到这个节点时，将自动触发一个特定的HTTP请求到日志采集服务器。</p>

<p>采集主要过程：</p>

<ol>
	<li>客户端日志采集

		<p>日志采集工作一般由一小段被植入页面HTML文档内的JavaScript脚本来执行。采集脚本被浏览器加载解析后执行，在执行时采集当前页面参数、浏览行为的上下文信息以及一些运行环境信息。</p></li>
	<li>客户端日志发送

		<p>采集脚本执行时，会向日志服务器发起一个日志请求，以将采集到的数据发送到日志服务器</p></li>
	<li>服务器端日志收集

		<p>日志服务器接收到客户端发来的日志请求后，一般会立即向浏览器发回一个请求成功的响应，同时日志服务器的日志收集模块会将日志请求内容写入一个日志缓冲区内，完成此条浏览日志的收集。</p></li>
	<li>服务器端日志解析存档

		<p>服务器接收到的浏览日志进入缓冲区后，会被一段专门的日志处理程序顺序独处并按照约定的日志处理逻辑解析，转存入标准的日志文件中并注入实时消息通道内供其他后端程序读取和进一步加工处理。</p></li>
</ol>

<h5>页面交互日志采集 流程</h5>

<p>PV日志的采集解决了页面流量和流量来源统计的问题，但随着互联网业务的发展，仅了解用户到访过的页面和访问路径，已经远远不能满足用户细分研究的需求。在很多场合下，需要了解用户在访问某个页面时具体的互动行为特征，比如鼠标或输入焦点的移动变化、对某些页面交互的反应等。</p>

<h5>页面日志的服务器端清洗和预处理</h5>

<hr />

<h3>无线客户端的日志采集</h3>

<h5>页面事件</h5>

<h5>控件点击及其他事件</h5>

<h5>特殊场景</h5>

<h5>H5&amp;Native日志统一</h5>

<h5>设备标识</h5>

<h5>日志传输</h5>

<hr />

<h3>日志采集挑战</h3>

<h5>典型场景</h5>

<ol>
	<li>日志分流与定制处理</li>
	<li>采集与计算一体化设计</li>
</ol>

</body>
</html>

