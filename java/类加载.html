<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<title>类加载</title>
	</head>
<body>
<h1>类加载</h1>

<blockquote>
<p>任何程序都需要加载到内存中才能和CPU进行交互。</p>
</blockquote>

<hr />

<h2>字节码主要指令</h2>

<ul>
	<li>加载或存储指令</li>
	<li>运算指令</li>
	<li>类型转换指令</li>
	<li>对象创建和访问指令

		<ul>
			<li>创建对象</li>
			<li>访问属性</li>
			<li>检查实例数据</li>
		</ul></li>
	<li>操作栈管理指令</li>
	<li>方法调用与返回</li>
	<li>同步指令</li>
</ul>

<hr />

<h2>类加载过程</h2>

<figure><img src="/Users/xerxes/note/java/src/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B.jpg"/></figure>

<p>字节码需要通过classloader加载到内存之后才可以实例化。</p>

<p>类加载是将字节码实例化成class对象并进行初始化的过程。</p>

<ul>
	<li>load：读取类文件，产生二进制流，初步校验，创建实例；</li>
	<li>link：

		<ul>
			<li>验证：更详细的校验；</li>
			<li>准备：为静态变量分配内存，并设定默认值；</li>
			<li>解析类和方法，确保类与类之间引用正确，完成内存结构布局</li>
		</ul></li>
	<li>init：执行类的<code>clinit</code>方法</li>
</ul>

<hr />

<h2>类加载器</h2>

<figure><img src="/Users/xerxes/note/java/src/%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%9E%8B.jpg"/></figure>

<ul>
	<li>bootstrap classloader：负责装载最核心的Java类，如object、string、system等；</li>
	<li>platform classloader：平台类加载器，用以加载一些扩展的系统类；</li>
	<li>application classloader：引用类加载器，加载用户定义在classpath上的类；</li>
	<li>user classloader：隔离加载类、修改类加载方式、扩展加载源、防止源码泄漏</li>
</ul>

</body>
</html>

